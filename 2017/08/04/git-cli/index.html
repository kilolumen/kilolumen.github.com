<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="DJ"><title>Git 常用命令及使用场景 | Kilolumen</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Git 常用命令及使用场景</h1><a id="logo" href="/.">Kilolumen</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Start</i></a><a href="/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/about/"><i class="fa fa-user"> Über</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Git 常用命令及使用场景</h1><div class="post-meta">2017-08-04</div><div class="post-content"><span id="more"></span>


<p>本文只写git命令相关内容，git安装及配置<a target="_blank" rel="noopener" href="https://git-scm.com/%E3%80%81github%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BArepository%E3%80%81%E6%B7%BB%E5%8A%A0ssh%E7%AD%89%EF%BC%8C%E8%AF%B7%E5%88%B0https://help.github.com/">https://git-scm.com/、github如何创建repository、添加ssh等，请到https://help.github.com/</a></p>
<p>以github作为远程仓库托管平台为例：</p>
<p>如果本地项目已经创建好，在github上创建好仓库（最好和项目同名）</p>
<p>本地切换到项目主目录 cd <path><br>git init     //创建初始化仓库<br>git add .        // 把工作区的修改的内容存入暂存区<br>git commit -m “提交信息”    // 把暂存区的文件保存为一个commit<br>git remote add origin <path>    // 添加远程仓库地址<br>git push -f origin master        // 把本地仓库修改push到远程仓库</p>
<p>如果已经有远程仓库：<br>git clone <repo_address>    // 把远程仓库克隆到本地</p>
<p>这里解释两个名词：<br>工作区：刚刚修改的文件，是被存储在工作区的。可以使用git status查看修改的文件，或者使用git diff查看修改的文件的详细内容<br>暂存区：一个缓存区，临时保存你的改动，git add 之后会把工作区的文件存入暂存区。可以执行git status查看分别存在工作区和暂存区修改的文件。存入暂存区后git diff就不能查看了，这时你可以执行git reset <filename>把暂存区的内容保存后工作区</p>
<p>基础使用：<br>下面逐个命令分析：</p>
<p>首先执行<br>git init<br>创建并初始化git仓库</p>
<p>创建仓库后，你可以执行：<br>git status<br>查看改动了那些文件</p>
<p>如果想看每个文件的具体改动，可以<br>git diff <filename></p>
<p>全部改动<br>git diff<br>但是查看改动的文件，只能在工作区，如果被添加到暂存区，就看不到了<br>我们可以把暂存区的改动撤销到工作区，请看下面的git reset</p>
<p>修改完成后，执行<br>git add <filename><br>把工作区中你修改的要提交的文件添加到暂存区</p>
<p>或者使用如下命令：<br>git add .<br>把工作区的全部修改添加到暂存区</p>
<p>更高级一点，你可以交互式的添加<br>git add -i</p>
<p>使用如下命令提交你的改动：<br>git commit -m “提交信息”</p>
<p>如果你想添加和提交一条命令：<br>git commit -am “提交信息”</p>
<p>假如你的”提交信息”输入错误，你可以执行：<br>git commit –amend<br>会进入你配置的编辑器，然后你可以修改你的”提交信息”。比如设置vim为编辑器<br>git config –global core.editor vim<br>git config –global core.editor /usr/bin/vim</p>
<p>或者直接<br>git commit –amend -m “新的提交信息”</p>
<p>提交完修改后，发现工作区有漏掉的文件没有提交，或者想把新修改的文件添加到最新的一次本地commit，你需要：<br>git add .<br>git commit –amend<br>这样，你的漏掉或者新的改动就会提交到最新的一次本地commit</p>
<p>你的改动现在只保存在本地仓库，执行如下命令可以推送你的改动到远端仓库<br>git push origin master<br>有时可能会push失败，需要（谨慎使用）<br>git push -f origin master<br>强制推送</p>
<p>如果你没有添加远端仓库地址，你可以执行<br>git remote add origin &lt;<a href="mailto:&#103;&#x69;&#116;&#x40;&#x67;&#105;&#x74;&#x68;&#117;&#x62;&#46;&#99;&#x6f;&#109;">&#103;&#x69;&#116;&#x40;&#x67;&#105;&#x74;&#x68;&#117;&#x62;&#46;&#99;&#x6f;&#109;</a>:you_github_name/you_repository_name.git&gt;<br>添加远程仓库地址</p>
<p>如果远程仓库别人有新的提交，你可以执行：<br>git pull<br>同步到你的本地仓库。第一次pull时，这时候可能会错误，按照错误提示修改一些就好了</p>
<p>分支（branch）：<br>多人协作工作时，一般会基于主分支创建自己的分支，执行自己的任务。任务完成后再把自己的分支合并到主分支。</p>
<p>你可以执行如下命令：<br>git branch<br>查看本地分支，或者<br>git branch -a<br>查看本地及远程分支</p>
<p>你可以基于当前分支创建新的分支，如新分支命名为new_branch<br>git branch <new_branch><br>或者基于指定的分支branch，创建新的分支new_branch<br>git branch <new_branch> <branch></p>
<p>创建好分支后，切换到新分支new_branch<br>git checkout <new_branch></p>
<p>以上两步可以用一条命令代替，创建新分支，并切换到新分支<br>git checkout -b <new_branch><br>或者<br>git checkout -b <new_branch> <branch></p>
<p>分支创建好后，只存在本地，只能自己看到，如果想同步到远程<br>git push origin <new_branch> <new_branch></p>
<p>git branch -v<br>可以查看每个分支最后的提交信息</p>
<p>如果你想删除某个分支，需要切换到其他分支，比如master:<br>git checkout master<br>再把新建的分支删掉：<br>git checkout -d <new_branch><br>当要删除的分支有为推送的commit时，删除失败，可以使用-D强制删除，如下<br>git checkout -D <new_branch></p>
<p>现在你知识删除了本地分支，远程的分支怎么删除呢，你可以执行：<br>git push origin :<new_branch><br>这行命令表示，你把一个空的分支同步到了new_branch，这样就删掉了</p>
<p>log:<br>如果你想查看本地仓库的提交记录，你可以执行<br>git log</p>
<p>你也可以添加一些参数，更精确的得到自己想要的结果，比如每条提交记录压缩为一行输出：<br>git log –pretty=oneline</p>
<p>只想查看某一个人的提交记录<br>git log –author=name</p>
<p>或者通过 ASCII 艺术的树形结构来展示所有的分支, 每个分支都标示了他的名字和标签<br>git log –graph –oneline –decorate –all</p>
<p>查看每次提交记录，改动了哪些文件<br>git log –name-status<br>想要查看更多参数，请参考：<br>git log –help</p>
<p>如果想要查看某个提交的改动的具体内容，可以执行<br>git show <commit_id></p>
<p>合并：<br>在你的分支完成任务，提交改动后，你需要把你的分支合并到主分支，如master：<br>git checkout master<br>合并前需要同步远程仓库到本地：<br>git pull<br>然后执行合并操作：<br>git merge <new_branch></p>
<p>合并前你可以查看改动前后的差异：<br>git diff master <new_branch></p>
<p>合并时冲突不是能完成避免的，产生冲突时如何你想撤销合并，执行，<br>git merge –abort<br>如果不想撤销，你可以解决冲突后，把工作区的文件暂存到暂存区：<br>git add .<br>然后继续完成合并：<br>git commit<br>然后把本地的更新推送的远程仓库：<br>git push</p>
<p>a -&gt; b -&gt; c -&gt; f – g -&gt; h (master)<br>               \          /<br>              d -&gt; e  (new_branch)</p>
<p>如上图，合并后生成新的commit_id: f</p>
<p>如果此时发现有bug，你想撤销合并，可以执行：<br>git reset –hard f</p>
<p>或者，使用revert撤销合并的内容:<br>git revert -m 1 g<br>（m指定主线，1代表parent）会生成一个新的提交G，如下图：<br>a -&gt; b -&gt; c -&gt; f – g -&gt; h -&gt; G (master)<br>                  \          /<br>                d -&gt; e  (new_branch)</p>
<p>如果new_branch的bug修改后，<br>a -&gt; b -&gt; c -&gt; f – g -&gt; h -&gt; G -&gt; i (master)<br>               \             /<br>               d -&gt; e -&gt; j -&gt; k (new_branch)<br>如果你直接合并，会丢失d和e的提交信息，所以你需要<br>git checkout master<br>git revert G<br>git merge new_branch<br>完成后，如下图：<br>a -&gt; b -&gt; c -&gt; f – g -&gt; h -&gt; G -&gt; i -&gt; G’ – m (master)<br>                 \            /                                       /<br>               d -&gt; e -&gt; j -&gt; k —————    (dev)</p>
<p>你可以用rebase进行合并，也就是变基操作，而且会减少不必要的合并信息，产生一个更简洁的提交历史：<br>git rebase master new_branch<br>git checkout master<br>git merge new_branch</p>
<p>有时候，我们需要把自己分支的某一个commit，合并到主分支，<br>git checkout master<br>git cherry-pick commit_id</p>
<p>合并某个分支上一系列相连的commits：<br>在一些特定情况下，合并单个commit并不够，你需要合并一系列相连的commits。这种情况下就不要选择cherry-pick了，rebase更适合。假如你需要合并feature分支的commit 23kj23j4~ak1kj23到master分支，首先你需要基于feature创建一个新的分支，并指明新的分支的最后一个commit：<br>git checkout -b new_branch ak1kj23</p>
<p>然后，rebase这个新分支的commit到master。23kj23j4^指明你想从哪个特定的commit开始。<br>git rebase –onto=master 23kj23j4^<br>得到的结果就是feature分支的commit 23kj23j4~ak1kj23都被合并到了master分支</p>
<p>修改改动：<br>有时我们会把暂存区的内容，想要查看改动的内容，或者不想本次提交，想要分两次提交，可以执行：<br>git checkout <filename><br>把暂存区的文件撤销到工作区</p>
<p>假如你想丢弃到本次的所有改动（工作区和暂存区），可以执行：<br>git reset –hard<br>撤销所有未commit的改动</p>
<p>如果你想撤销最后一次提交（未推送到远程），可以执行：<br>git reset HEAD^<br>撤销最后一次提交（未push的远程）到工作区，如果已push到远程，会创建一个新的commit，同revert</p>
<p>你也撤销指定的commit_id之后的所有提交，并把改动内容撤销到工作区<br>git reset commit_id</p>
<p>也可以直接抛弃掉：<br>git reset –hard commit_id</p>
<p>如果要丢弃掉所有本地改动与提交，可以到服务器上获取最新的版本历史，并将你本地主分支指向它<br>git reset –hard origin/master</p>
<p>如果想回退版本后，再修改回来，你需要使用<br>git revert<br>进行版本回退，会产生一个新的提交内容G<br>如果想修改回来，再执行：<br>git revert G<br>就可以了</p>
<p>你可以撤销前一次的commit：<br>git revert HEAD</p>
<p>或者撤销前前一次的commit：<br>git revert HEAD^</p>
<p>甚至撤销指定的commit<br>git revert commit-id</p>
<p>储藏（stash）：<br>有时我们改动的文件后，想要更新远程的改动、或者不想提交需要先保存起来、或者想要应用到不同的分支，这是我们可以使用：<br>git stash</p>
<p>我们可知储藏的改动添加说明信息：<br>git stash save “说明嘻嘻”</p>
<p>也可以查看储藏几条：<br>git stash list</p>
<p>可以查看每一条改动的文件：<br>git stash show <stash_id></p>
<p>或者把某一个储藏内容，应用到当前分支，并不从储藏室删除：<br>git stash apply <stash_id></p>
<p>或者直接应用到分支，并且删除：<br>git stash pop<br>默认是最新的一条stash</p>
<p>也可指定stash：<br>git stash pop <stash_id></p>
<p>apply或者pop是可能会产生冲突，如果pop时产生冲突，就不会立即从储藏室删除了</p>
<p>如果想删除掉储藏室的某一条：<br>git stash drop <stash_id></p>
<p>或者直接清除储藏室：<br>git stash clear</p>
<p>查找：</p>
<p>如果想要查看文件的每个部分是谁修改的，那么git blame就是不二选择，可以看到每一行的详细修改信息：包括SHA串，日期和作者<br>git blame <filename></p>
<p>如果想查找某一段文字，比如 Macro_iPad<br>git grep Macro_iPad</p>
<p>还可以显示行号<br>git grep -n Macro_iPad</p>
<p>或者只显示文件名<br>git grep –name-only Macro_iPad</p>
<p>每个文件里有多少行匹配内容<br>git grep -c Macro_iPad</p>
<p>或者某个tag里的内容<br>git grep Macro_iPad v1.1.0</p>
<p>git bisect<br>有时你可能会遇到这种情况：<br>如果一个代码仓库中发现了一个bug，想要找到出现bug的commit，再修复bug时，可以使用git checkout到很久的一个commit，然后查看是否存在bug，如果没有再git checkout到这个commit和最新的commit中间的一个commit，查看是否存在bug，以这种二分查找法查找。是的，我最初是这么做的，现在我告诉你一个更方便的方法，git disect，git 自带的二分查找。<br>git bisect start<br>git bisect good <good_commit><br>git bisect bad <bad_commit><br>git bisect good<br>git bisect good<br>git bisect bad<br>git bisect good<br>……<br>git bisect reset     // 退出</p>
<p>git bisect最初是用于寻找bug的引入的坏点而不是fix bug的好点，如果某个bug被不知不觉的修复了，故想要查找修复的bug的commit时，只要把good和bad的概念颠倒一些就可以了<br>git bisect start<br>git bisect good <bad_commit><br>git bisect bad <good_commit><br>……<br>git bisect reset</p>
<p>git fsck -lost-found<br>commit删除后，变成dangling commit(悬空对象)，并不是真正的删除，只要把dangling commit(悬空对象)找出来，git rebase或git merge把他们恢复</p>
<p>其他：</p>
<p>查看远程仓库地址：<br>git remote -v</p>
<p>删除远程仓库：<br>git remote rm origin</p>
<p>添加多个远程仓库<br>git remote set-url –add origin <repo_address><br>可以在配置中查看<br>.git/config</p>
<p>有时远程别人的分支已经删除了，本地却还能看到，可以执行<br>git fetch -p<br>同步一下，这样本地也就没有了</p>
<p>软件发布时，推荐为每个版本创建一个标签，方便以后的管理<br>git tag 1.0 <commit_id></p>
<p>推荐的开发流程：<br>基于主分支创建自己的分支-&gt;完成任务后，提交commit-&gt;把自己的分支推送到github-&gt;在github上创建一个pull request-&gt;其他开发人员review-&gt;没有问题后合并到主分支</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2018/10/10/Install-Hexo/">Install Hexo</a><a class="next" href="/2016/11/01/British-Shorthair/">British Shorthair</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.ioswifter.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Kategorien</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/%E5%AE%A0%E7%89%A9/" style="font-size: 15px;">宠物</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/07/07/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/10/Install-Hexo/">Install Hexo</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/04/git-cli/">Git 常用命令及使用场景</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/01/British-Shorthair/">British Shorthair</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/22/Mac-Keyboard-shortcut/">Mac Keyboard shortcut</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/13/NSURLSessionDownloadTask-usage/">NSURLSessionDownloadTask后台下载遇到的几种情况</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/22/NSOperationQueue-use/">什么情况下使用NSOperationQueue</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/18/notes-1/">产品记事</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/27/lldb-and-chisel/">lldb and chisel</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/26/Emacs-Keyboard-shortcut/">Emacs Keyboard shortcut</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="https://dribbble.com/" title="Dribbble" target="_blank">Dribbble</a><ul></ul><a href="www.flickr.com/" title="Flickr" target="_blank">Flickr</a><ul></ul><a href="https://pixabay.com" title="Pixabay" target="_blank">Pixabay</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">Kilolumen.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>